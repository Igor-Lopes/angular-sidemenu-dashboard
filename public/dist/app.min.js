"use strict";angular.module("dashboard",["ngRoute","ngStorage","chart.js","angularModalService","angular-table","cgNotify","alexjoffroy.angular-loaders","ngMessages","ngAnimate","ngSanitize","ui.utils.masks","zxcvbn","validation.match","angularMoment"]).config(function($routeProvider,$locationProvider,$httpProvider){$locationProvider.hashPrefix(""),$httpProvider.defaults.withCredentials=!0,$routeProvider.when("/",{templateUrl:"app/views/home/home.html",controller:"HomeCtrl as homeCtrl",resolve:{access:function(Auth){return Auth.isAuthenticated()}}}).when("/consultores",{templateUrl:"app/views/admins/admins.html",controller:"AdminsCtrl as adminsCtrl",resolve:{access:function(Auth){return Auth.isAuthenticated()}}}).when("/categorias",{templateUrl:"app/views/categories/categories.html",controller:"categoriesCtrl as categoriesCtrl",resolve:{access:function(Auth){return Auth.isAuthenticated()}}}).when("/tables",{templateUrl:"app/views/uiElements/tables.html",controller:"TablesCtrl as tablesCtrl",resolve:{access:function(Auth){return Auth.isAuthenticated()}}}).when("/forms",{templateUrl:"app/views/uiElements/forms.html",controller:"FormsCtrl as formsCtrl",resolve:{access:function(Auth){return Auth.isAuthenticated()}}}).when("/buttons",{templateUrl:"app/views/uiElements/buttons.html",controller:"ButtonsCtrl as buttonsCtrl",resolve:{access:function(Auth){return Auth.isAuthenticated()}}}).when("/notifications",{templateUrl:"app/views/uiElements/notifications.html",controller:"NotificationsCtrl as notificationsCtrl",resolve:{access:function(Auth){return Auth.isAuthenticated()}}}).when("/modals",{templateUrl:"app/views/uiElements/modals.html",controller:"ModalsCtrl as modalsCtrl",resolve:{access:function(Auth){return Auth.isAuthenticated()}}}).when("/blank",{templateUrl:"app/views/pages/blank.html",controller:"BlankCtrl as blankCtrl",resolve:{access:function(Auth){return Auth.isAuthenticated()}}}).when("/login",{templateUrl:"app/views/auth/login.html",controller:"LoginCtrl",controllerAs:"loginCtrl"}).when("/cadastrar",{templateUrl:"app/views/auth/register.html",controller:"RegisterCtrl",controllerAs:"registerCtrl"}).when("/recuperar",{templateUrl:"app/views/auth/forgot.html",controller:"ForgotCtrl",controllerAs:"forgotCtrl"}).when("/consultores/:recoveryKey/redefinir-senha/:token",{templateUrl:"app/views/auth/reset.html",controller:"ResetCtrl",controllerAs:"resetCtrl"}).when("/activation/:token",{templateUrl:"app/views/auth/activation.html",controller:"ActivationCtrl",controllerAs:"activationCtrl"}).otherwise({redirectTo:"/"})}).run(function($rootScope,$location){$rootScope.$on("$routeChangeStart",function(event,next,current){console.log("Route Start")}),$rootScope.$on("$routeChangeError",function(event,current,previous,rejection){console.log("Route Change Error: "+rejection),$location.path("/login")}),$rootScope.$on("$routeChangeSuccess",function(event,current,previous){void 0!==previous&&console.log("Previous Url: "+previous.originalPath),console.log("Current Url: "+current.originalPath)})}),angular.module("dashboard").controller("AdminsCtrl",["$scope","filterFilter","Admins","Account","ModalService","notify","$localStorage","Socket",function($scope,filterFilter,Admins,Account,ModalService,notify,$localStorage,Socket){var vm=this;vm.filter="Filtros",vm.config={itemsPerPage:10},null==$localStorage.personList&&($localStorage.personList=[],Admins.getAdmins().then(function(res){for(var i=0;i<res.data.length;i++)$localStorage.personList.push(res.data[i])})),Socket.on("admin add",function(msg){$localStorage.personList.push(msg)}),Socket.on("admin active",function(msg){$localStorage.personList.filter(function(item){item._id===msg&&(item.isActive=!0)}),vm.filteredList=$localStorage.personList}),vm.filteredList=$localStorage.personList,vm.updateList=function(){vm.filter="Filtros",vm.filteredList=filterFilter($localStorage.personList,vm.key)},vm.update=function(){vm.key="";var key="";key=1==vm.filter||2!=vm.filter&&"",vm.filteredList=filterFilter($localStorage.personList,key)},vm.active=function(_id,email,isActive){vm.alertTitle=isActive?"Desativar usuário":"Ativar usuário",vm.alertQuestion=isActive?"Você desja realmente desativar este usuário?":"Você deseja realmente ativar este usuário?",vm.template="",vm.position="center",vm.duration="3000",ModalService.showModal({templateUrl:"app/views/modals/alert.html",controller:"AlertModalCtrl as alertModalCtrl",inputs:{title:vm.alertTitle,question:vm.alertQuestion,user:email}}).then(function(modal){modal.element.modal(),modal.close.then(function(result){result&&Account.active(_id).then(function(res){Socket.emit("admin active",_id),vm.msg=isActive?"Usuário desativado com sucesso":"Usuário ativado com sucesso",vm.classes="alert-success",notify({message:vm.msg,classes:vm.classes,templateUrl:vm.template,position:vm.position,duration:vm.duration})}).catch(function(err){vm.msg=isActive?"Erro ao tentar desativar o usuário":"Erro ao tentar ativar o usuário",vm.classes="alert-danger",notify({message:vm.msg,classes:vm.classes,templateUrl:vm.template,position:vm.position,duration:vm.duration})})})})}}]),angular.module("dashboard").controller("ActivationCtrl",["$scope",function($scope){var vm=this;vm.success=!1,vm.activationSuccess=!1,vm.danger=!0,vm.activationDanger=!0,vm.errLogin=!1,vm.resend=!1,vm.hidepassword=!0,vm.show=!0,vm.hide=!1,vm.toggle=function(param){"show"===param?(vm.hidepassword=!1,vm.show=!1,vm.hide=!0):(vm.hidepassword=!0,vm.show=!0,vm.hide=!1)},vm.close=function(code){0==code?vm.activationSuccess=!1:1==code?vm.activationDanger=!1:2==code?vm.errLogin=!1:vm.resend=!1},vm.submit=function(){vm.activationSuccess=!1,vm.errLogin=!0},vm.send=function(){vm.activationDanger=!1,vm.resend=!0}}]),angular.module("dashboard").controller("ForgotCtrl",["$scope","Account","$compile",function($scope,Account,$compile){var vm=this;vm.send=!1,vm.close=function(){vm.send=!1},vm.submit=function(){$scope.ForgotForm.$invalid||Account.setRecoveryToken({recoveryKey:vm.user.email}).then(function(res){200==res.status&&(vm.send=!0,$scope.ForgotForm.$setPristine(),vm.user.email="")}).catch(function(err){console.log(err)})}}]),angular.module("dashboard").controller("LoginCtrl",["$scope","Auth","$location",function($scope,Auth,$location){var vm=this;vm.hidepassword=!0,vm.show=!0,vm.hide=!1,vm.errLogin=!1,vm.toggle=function(param){"show"===param?(vm.hidepassword=!1,vm.show=!1,vm.hide=!0):(vm.hidepassword=!0,vm.show=!0,vm.hide=!1)},vm.close=function(){vm.errLogin=!1},vm.submit=function(){$scope.LoginForm.$invalid?vm.errLogin=!0:Auth.login(vm.user.email,vm.user.password).then(function(res){200==res.status&&res.data&&res.data.isActive?$location.path("/"):vm.errLogin=!0}).catch(function(err){vm.errLogin=!0})}}]),angular.module("dashboard").controller("RegisterCtrl",["$scope","Account","Socket",function($scope,Account,Socket){var vm=this,_id=-1;vm.hidepasswordA=!0,vm.hidepasswordB=!0,vm.showA=!0,vm.hideA=!1,vm.showB=!0,vm.hideB=!1,vm.create=!0,vm.sendSuccess=!1,vm.sendDanger=!1,vm.toggle=function(param){"showA"===param?(vm.hidepasswordA=!1,vm.showA=!1,vm.hideA=!0):"hideA"===param?(vm.hidepasswordA=!0,vm.showA=!0,vm.hideA=!1):"showB"===param?(vm.hidepasswordB=!1,vm.showB=!1,vm.hideB=!0):(vm.hidepasswordB=!0,vm.showB=!0,vm.hideB=!1)},vm.submit=function(){$scope.RegisterForm.$invalid||Account.signup(vm.user.name,vm.user.email,vm.user.password).then(function(res){res.data&&(_id=res.data._id,vm.user._id=_id,vm.user.isActive=!1,Socket.emit("admin add",vm.user)),vm.create=!1})},vm.send=function(){-1!=_id&&Account.setActivationCode(_id).then(function(res){200==res.status?(vm.sendSuccess=!0,vm.sendDanger=!1):(vm.sendSuccess=!1,vm.sendDanger=!0)})},vm.close=function(code){0==code?vm.sendSuccess=!1:vm.sendDanger=!1}}]),angular.module("dashboard").controller("ResetCtrl",["$scope","Account","$routeParams","$location",function($scope,Account,$routeParams,$location){var vm=this;vm.hidepasswordA=!0,vm.hidepasswordB=!0,vm.showA=!0,vm.hideA=!1,vm.showB=!0,vm.hideB=!1,vm.resetSuccess=!1,vm.resetDanger=!1,vm.toggle=function(param){"showA"===param?(vm.hidepasswordA=!1,vm.showA=!1,vm.hideA=!0):"hideA"===param?(vm.hidepasswordA=!0,vm.showA=!0,vm.hideA=!1):"showB"===param?(vm.hidepasswordB=!1,vm.showB=!1,vm.hideB=!0):(vm.hidepasswordB=!0,vm.showB=!0,vm.hideB=!1)},vm.submit=function(){$scope.ResetForm.$invalid?(vm.resetSuccess=!1,vm.resetDanger=!0):Account.recoverPassword($routeParams.recoveryKey,$routeParams.token,vm.user.password).then(function(res){vm.resetSuccess=!0,vm.resetDanger=!1,$location.path("/login")}).catch(function(err){vm.resetSuccess=!1,vm.resetDanger=!0})},vm.close=function(code){0?vm.resetSuccess=!1:vm.resetDanger=!1}}]),angular.module("dashboard").controller("categoriesCtrl",["$scope","filterFilter","Categories","Account","ModalService","notify","$localStorage","Socket",function($scope,filterFilter,Categories,Account,ModalService,notify,$localStorage,Socket){var vm=this;vm.filter="Filtros",vm.template="",vm.position="center",vm.duration="3000",vm.config={itemsPerPage:10},null==$localStorage.categoryList&&($localStorage.categoryList=[],Categories.getCategories().then(function(res){for(var i=0;i<res.data.length;i++)$localStorage.categoryList.push(res.data[i])})),vm.filteredList=$localStorage.categoryList,Socket.on("category create",function(msg){$localStorage.categoryList.push(msg)}),Socket.on("category update",function(msg){$localStorage.categoryList.filter(function(item){item._id===msg._id&&(item.title=msg.title)}),vm.filteredList=$localStorage.categoryList}),vm.updateList=function(){vm.filter="Filtros",vm.filteredList=filterFilter($localStorage.categoryList,vm.key)},vm.update=function(){vm.key="";var key="";key=1==vm.filter||2!=vm.filter&&"",vm.filteredList=filterFilter($localStorage.categoryList,key)},vm.create=function(){vm.alertTitle="Aqui você cria suas categorias",vm.label="Criar",vm.input="",ModalService.showModal({templateUrl:"app/views/modals/category-form-modal.html",controller:"CategoryFormModalCtrl as categoryFormModalCtrl",inputs:{title:vm.alertTitle,input:vm.input,label:vm.label}}).then(function(modal){modal.element.modal(),modal.close.then(function(result){vm.msg=result?"Categoria criada com sucesso":"Sua nova categoria não foi criada",vm.classes=result?"alert-success":"alert-danger",result?Categories.createCategory(result.name).then(function(res){Socket.emit("category create",res.data),notify({message:vm.msg,classes:vm.classes,tamplateUrl:vm.template,position:vm.position,duration:vm.duration})}).catch(function(err){vm.msg="Erro ao tentar criar a nova categoria",vm.classes="alert-danger",notify({message:vm.msg,classes:vm.classes,tamplateUrl:vm.template,position:vm.position,duration:vm.duration})}):notify({message:vm.msg,classes:vm.classes,tamplateUrl:vm.template,position:vm.position,duration:vm.duration})})})},vm.delete=function(id){vm.alertTitle="Deletar categoria",vm.alertQuestion="Tem certeza que deseja deletar esta categoria?",$localStorage.categoryList.filter(function(item){item._id===id&&(vm.user=item.title,ModalService.showModal({templateUrl:"app/views/modals/alert.html",controller:"AlertModalCtrl as alertModalCtrl",inputs:{title:vm.alertTitle,question:vm.alertQuestion,user:vm.user}}).then(function(modal){modal.element.modal(),modal.close.then(function(result){result&&Categories.deleteCategory(id).then(function(res){console.log(res)}).catch(function(err){console.log(err)})})}))})},vm.edit=function(id){vm.alertTitle="Atualize sua categoria abaixo",vm.label="Atualizar",$localStorage.categoryList.filter(function(item){item._id===id&&(vm.input=item.title,ModalService.showModal({templateUrl:"app/views/modals/category-form-modal.html",controller:"CategoryFormModalCtrl as categoryFormModalCtrl",inputs:{title:vm.alertTitle,input:vm.input,label:vm.label}}).then(function(modal){modal.element.modal(),modal.close.then(function(result){vm.msg=result?"Categoria atualizada com sucesso":"Esta categoria não foi atualizada",vm.classes=result?"alert-success":"alert-danger",result?Categories.updateCategory(id,result.name).then(function(res){Socket.emit("category update",res.data),notify({message:vm.msg,classes:vm.classes,tamplateUrl:vm.template,position:vm.position,duration:vm.duration})}).catch(function(err){vm.msg="Erro ao tentar atualizar a categoria",vm.classes="alert-danger",notify({message:vm.msg,classes:vm.classes,tamplateUrl:vm.template,position:vm.position,duration:vm.duration})}):notify({message:vm.msg,classes:vm.classes,tamplateUrl:vm.template,position:vm.position,duration:vm.duration})})}))})}}]),angular.module("dashboard").controller("HomeCtrl",["$scope","$timeout",function($scope,$timeout){var vm=this;vm.labels=["January","February","March","April","May","June","July"],vm.series=["Series A","Series B"],vm.data=[[65,59,80,81,56,55,40],[28,48,40,19,86,27,90]],vm.onClick=function(points,evt){console.log(points,evt)},$timeout(function(){vm.data=[[28,48,40,19,86,27,90],[65,59,80,81,56,55,40]]},3e3),vm.donutLabels=["Download Sales","In-Store Sales","Mail-Order Sales"],vm.donutData=[300,500,100],vm.infos=[{label:"Consultores",number:"3"},{label:"New Orders",number:"12"},{label:"Reports",number:"22"},{label:"Issues",number:"5"}]}]),angular.module("dashboard").controller("AlertModalCtrl",["$scope","ModalService","close","title","question","user",function($scope,ModalService,close,title,question,user){var vm=this;vm.title=title,vm.question=question,vm.user=user,vm.close=function(result){close(result,500),angular.element(".modal").modal("hide")}}]),angular.module("dashboard").controller("CategoryFormModalCtrl",["$scope","ModalService","close","title","input","label",function($scope,ModalService,close,title,input,label){var vm=this;vm.title=title,vm.label=label,vm.inputs={name:input},vm.close=function(result){close(result?vm.inputs:null,500),angular.element(".modal").modal("hide")}}]),angular.module("dashboard").controller("FormModalCtrl",["$scope","ModalService","close",function($scope,ModalService,close){var vm=this;vm.inputs=[],vm.title="My Title",vm.question="My Question",vm.close=function(result){close(vm.inputs,500),angular.element(".modal").modal("hide")}}]),angular.module("dashboard").controller("BlankCtrl",["$scope",function($scope){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("dashboard").controller("NavbarCtrl",["$scope","Auth","$location",function($scope,Auth,$location){this.logout=function(){Auth.logout().then(function(res){$location.path("/login")}).catch(function(err){})}}]),angular.module("dashboard").controller("ButtonsCtrl",["$scope",function($scope){}]),angular.module("dashboard").controller("FormsCtrl",["$scope",function($scope){var vm=this;vm.inputs=[],vm.alertMessage={},vm.submit=function(){$scope.sampleForm.$valid?(vm.alertMessage.type="success",vm.alertMessage.message="Form is valid !"):(vm.alertMessage.type="danger",vm.alertMessage.message="Form is invalid !"),vm.alertMessage.show=!0},vm.closeAlert=function(){vm.alertMessage.show=!1}}]),angular.module("dashboard").controller("ModalsCtrl",["$scope","ModalService",function($scope,ModalService){var vm=this;vm.alertTitle="I wanna know the answer",vm.alertQuestion="Do you like beer ?",vm.showAlertModal=function(){ModalService.showModal({templateUrl:"app/views/modals/alert.html",controller:"AlertModalCtrl as alertModalCtrl",inputs:{title:vm.alertTitle,question:vm.alertQuestion}}).then(function(modal){modal.element.modal(),modal.close.then(function(result){vm.alertResult=result?"You said Yes":"You said No"})})},vm.showFormModal=function(){ModalService.showModal({templateUrl:"app/views/modals/form-modal.html",controller:"FormModalCtrl as formModalCtrl"}).then(function(modal){modal.element.modal(),modal.close.then(function(result){vm.formResult=result})})}}]),angular.module("dashboard").controller("NotificationsCtrl",["$scope","notify",function($scope,notify){var vm=this;vm.msg="Hello! This is a sample message!",vm.template="",vm.positions=["center","left","right"],vm.position=vm.positions[0],vm.duration=1e4,vm.demo=function(){notify({message:vm.msg,classes:vm.classes,templateUrl:vm.template,position:vm.position,duration:vm.duration})},vm.closeAll=function(){notify.closeAll()},vm.demoMessageTemplate=function(){notify({messageTemplate:'<span>This is an example using a dynamically rendered Angular template for the message text. I can have <a href="" ng-click="clickedLink()">hyperlinks</a> with ng-click or any valid Angular enhanced html.</span>',classes:vm.classes,scope:$scope,templateUrl:vm.template,position:vm.position})},vm.clickedLink=function(){notify("You clicked a link!")}}]),angular.module("dashboard").controller("TablesCtrl",["filterFilter","$scope","$http","$filter",function(filterFilter,$scope,$http,$filter){var vm=this;vm.config={itemsPerPage:5},vm.personList=[{index:1,name:"Kristin Hill",email:"kristin@hill.com"},{index:2,name:"Valerie Francis",email:"valerie@francis.com"},{index:3,name:"Bob Abbott",email:"bob@abbott.com"},{index:4,name:"Greg Boyd",email:"greg@boyd.com"},{index:5,name:"Peggy Massey",email:"peggy@massey.com"},{index:6,name:"Janet Bolton",email:"janet@bolton.com"},{index:7,name:"Maria Liu",email:"maria@liu.com"},{index:8,name:"Anne Warren",email:"anne@warren.com"},{index:9,name:"Keith Steele",email:"keith@steele.com"},{index:10,name:"Jerome Lyons",email:"jerome@lyons.com"},{index:11,name:"Jacob Stone",email:"jacob@stone.com"},{index:12,name:"Marion Dunlap",email:"marion@dunlap.com"},{index:13,name:"Stacy Robinson",email:"stacy@robinson.com"},{index:14,name:"Luis Chappell",email:"luis@chappell.com"},{index:15,name:"Kimberly Horne",email:"kimberly@horne.com"},{index:16,name:"Andy Smith",email:"andy@smith.com"}],vm.filteredList=vm.personList,vm.updateList=function(){vm.filteredList=filterFilter(vm.personList,vm.key)}}]),angular.module("dashboard").directive("isActive",function(){return{restrict:"AEC",require:"ngModel",scope:{ngModel:"=ngModel"},link:function(scope,iElement,iAttrs,ngModelCtrl){scope.$watch("ngModel",function(value){console.log("alterou"),value&&console.log(value)})}}}),angular.module("dashboard").directive("linkSidebar",function(){return{restrict:"AEC",priority:10,controller:["$scope","$location",function($scope,$location){$scope.path=function(href){$location.path(href)}}],link:function(scope,iElement,iAttrs,ngModelCtrl){iElement.bind("click",function(){scope.path(iAttrs.href),scope.$apply()})}}}),angular.module("dashboard").directive("linkSidebarClose",function(){return{restrict:"AEC",priority:900,link:function(scope,iElement,iAttrs,ngModelCtrl){var width=angular.element(window).width();iElement.bind("click",function(){width<768&&(angular.element("#sidebar").removeClass("sidebar-visible"),angular.element("#navbarContainer").removeClass("layout-sidebar-l3-md-up"))})}}}),angular.module("dashboard").directive("menuSidebar",function(){return{restrict:"AEC",templateUrl:"app/directives/menuSidebar/menuSidebar.html",controller:"MenuSidebarCtrl as menuSidebarCtrl",link:function(scope,iElement,iAttrs,ngModelCtrl){var toogle=function(){angular.element("#sidebar").toggleClass("sidebar-visible"),angular.element("#navbarContainer").toggleClass("layout-sidebar-l3-md-up")};angular.element(window).width()<768&&(angular.element("#sidebar").hasClass("sidebar-visible")&&(angular.element("#sidebar").toggleClass("sidebar-visible"),angular.element("#navbarContainer").toggleClass("layout-sidebar-l3-md-up")),angular.element(".side-toogle").bind("click",function(){angular.element("#sidebar").hasClass("sidebar-visible")&&toogle()}))}}}),angular.module("dashboard").controller("MenuSidebarCtrl",["$scope",function($scope){this.menuItens=[{icon:"dashboard",label:"Dashboard",href:"/",hasSubmenu:!1,submenu:[]},{icon:"supervisor_account",label:"Consultores",href:"/consultores",hasSubmenu:!1,submenu:[]},{icon:"list",label:"Categorias",href:"/categorias",hasSubmenu:!1,submenu:[]}]}]),angular.module("dashboard").directive("sidebarToogler",function(){return{restrict:"AEC",link:function(scope,iElement,iAttrs,ngModelCtrl){iElement.bind("click",function(){angular.element("#sidebar").toggleClass("sidebar-visible"),angular.element("#navbarContainer").toggleClass("layout-sidebar-l3-md-up")})}}}),angular.module("dashboard").directive("strengthPassword",function(){return{restrict:"AEC",scope:{strength:"="},templateUrl:"app/directives/strengthPassword/strengthPassword.html",link:function(scope,iElement,iAttrs,ctrl){var removeColor=function(meter){angular.element("#worst").removeClass("strength-meter-"+meter),angular.element("#bad").removeClass("strength-meter-"+meter),angular.element("#weak").removeClass("strength-meter-"+meter),angular.element("#good").removeClass("strength-meter-"+meter),angular.element("#strong").removeClass("strength-meter-"+meter)},clear=function(){removeColor("worst"),removeColor("bad"),removeColor("weak"),removeColor("good"),removeColor("strong")};scope.$watch("strength",function(value){clear(),value.password?(0==value.score&&angular.element("#worst").addClass("strength-meter-worst"),1==value.score&&(angular.element("#worst").addClass("strength-meter-bad"),angular.element("#bad").addClass("strength-meter-bad")),2==value.score&&(angular.element("#worst").addClass("strength-meter-weak"),angular.element("#bad").addClass("strength-meter-weak"),angular.element("#weak").addClass("strength-meter-weak")),3==value.score&&(angular.element("#worst").addClass("strength-meter-good"),angular.element("#bad").addClass("strength-meter-good"),angular.element("#weak").addClass("strength-meter-good"),angular.element("#good").addClass("strength-meter-good")),4==value.score&&(angular.element("#worst").addClass("strength-meter-strong"),angular.element("#bad").addClass("strength-meter-strong"),angular.element("#weak").addClass("strength-meter-strong"),angular.element("#good").addClass("strength-meter-strong"),angular.element("#strong").addClass("strength-meter-strong"))):clear()})}}}),angular.module("dashboard").directive("submenuSidebar",function(){return{restrict:"AEC",link:function(scope,iElement,iAttrs,ngModelCtrl){var clear=function(){var items=angular.element(".sidebar-menuItem-button");angular.forEach(items,function(item){angular.element(item).parent().removeClass("open")})};iElement.bind("click",function(){angular.element(iElement).parent().hasClass("open")||clear(),angular.element(iElement).parent().toggleClass("open")})}}}),angular.module("dashboard").directive("uiBrCellphone",function(){return{restrict:"AEC",require:"ngModel",scope:{ngModel:"=ngModel"},controller:["$scope",function($scope){$scope.verifyPartnerPhoneNumber=function(phoneNumber,view){view.$setValidity("phoneNumberExists",!0)}}],link:function(scope,iElement,iAttrs,ngModelCtrl){ngModelCtrl.$parsers.push(function(number){var input=number.replace(/[^0-9]/g,"");return input!==number&&(ngModelCtrl.$setViewValue(input),ngModelCtrl.$render()),Number(input)}),scope.$watch("ngModel",function(value){if(value){var str=""+value,len=str.length;if(len<11||len>11)if(19==len)"55"==(country=str.slice(1,3))?"11"==(state=str.slice(5,7))||"12"==state||"13"==state||"14"==state||"15"==state||"16"==state||"17"==state||"18"==state||"19"==state||"21"==state||"22"==state||"24"==state||"27"==state||"28"==state||"31"==state||"32"==state||"33"==state||"34"==state||"35"==state||"37"==state||"38"==state||"41"==state||"42"==state||"43"==state||"44"==state||"45"==state||"46"==state||"47"==state||"48"==state||"49"==state||"51"==state||"53"==state||"54"==state||"55"==state||"61"==state||"62"==state||"63"==state||"64"==state||"65"==state||"66"==state||"67"==state||"68"==state||"69"==state||"71"==state||"73"==state||"74"==state||"75"==state||"77"==state||"79"==state||"81"==state||"82"==state||"83"==state||"84"==state||"85"==state||"86"==state||"87"==state||"88"==state||"89"==state||"91"==state||"92"==state||"93"==state||"94"==state||"95"==state||"96"==state||"97"==state||"98"==state||"99"==state?(ngModelCtrl.$setValidity("invalidCellphone",!0),scope.verifyPartnerPhoneNumber(value,ngModelCtrl)):ngModelCtrl.$setValidity("invalidCellphone",!1):(ngModelCtrl.$setValidity("phoneNumberExists",!0),ngModelCtrl.$setValidity("invalidCellphone",!1));else if(13==len)if("55"==(country=str.slice(0,2))){mask="+"+country+" "+(state="("+str.slice(2,4)+")")+" "+(initial=str.slice(4,9))+"-"+(finish=str.slice(9,13));scope.ngModel=mask}else ngModelCtrl.$setValidity("phoneNumberExists",!0),ngModelCtrl.$setValidity("invalidCellphone",!1);else ngModelCtrl.$setValidity("phoneNumberExists",!0),ngModelCtrl.$setValidity("invalidCellphone",!1);else if("55"!=str.slice(0,2)){var country="+55",state="("+str.slice(0,2)+")",initial=str.slice(2,7),finish=str.slice(7,11),mask=country+" "+state+" "+initial+"-"+finish;scope.ngModel=mask}else ngModelCtrl.$setValidity("phoneNumberExists",!0),ngModelCtrl.$setValidity("invalidCellphone",!1)}else ngModelCtrl.$setValidity("phoneNumberExists",!0),ngModelCtrl.$setValidity("invalidCellphone",!0)})}}}),angular.module("dashboard").directive("uiBrName",function(){return{restrict:"AEC",require:"ngModel",scope:{ngModel:"=ngModel"},link:function(scope,iElement,iAttrs,ngModelCtrl){ngModelCtrl.$parsers.push(function(textName){var input=textName.replace(/[^a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-+$]/g,"");return input!==textName&&(ngModelCtrl.$setViewValue(input),ngModelCtrl.$render()),String(input)}),scope.$watch("ngModel",function(value){if(value){var textValue=""+value;scope.ngModel=textValue.replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()}),-1==scope.ngModel.search(" ")?ngModelCtrl.$setValidity("minname",!1):ngModelCtrl.$setValidity("minname",!0)}else ngModelCtrl.$setValidity("minname",!0)})}}}),angular.module("dashboard").directive("uiEmail",function(){return{restrict:"AEC",require:"ngModel",scope:{ngModel:"=ngModel"},controller:["$scope","Verification",function($scope,Verification){$scope.adminVerifyEmail=function(email,view){Verification.adminVerifyEmail(email).then(function(res){view.$setValidity("emailExists",!0)}).catch(function(err){422==err.status&&view.$setValidity("emailExists",!1),404==err.status&&view.$setValidity("emailExists",!0)})}}],link:function(scope,iElement,iAttrs,ngModelCtrl){scope.$watch("ngModel",function(value){value?(""+value).match(/^(([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5}){1,25})+([;,.](([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5}){1,25})+)*$/)?(ngModelCtrl.$setValidity("invalidEmail",!0),iAttrs.uiEmail?"registered"==iAttrs.uiEmail?scope.adminVerifyEmail(scope.ngModel,ngModelCtrl):"no-registered"==iAttrs.uiEmail||scope.adminVerifyEmail(scope.ngModel,ngModelCtrl):scope.adminVerifyEmail(scope.ngModel,ngModelCtrl)):(ngModelCtrl.$setValidity("invalidEmail",!1),ngModelCtrl.$setValidity("emailExists",!0)):(ngModelCtrl.$setValidity("invalidEmail",!0),ngModelCtrl.$setValidity("emailExists",!0))})}}}),angular.module("dashboard").directive("verifyCategory",function(){return{restrict:"AEC",require:"ngModel",scope:{ngModel:"=ngModel"},controller:["$scope","Categories",function($scope,Categories){$scope.verifyCategory=function(name,view){Categories.getCategories().then(function(res){res.data.filter(function(item){item.title.toUpperCase()===name&&view.$setValidity("categoryExists",!1)})})}}],link:function(scope,iElement,iAttrs,ngModelCtrl){ngModelCtrl.$parsers.push(function(textName){var input=textName.replace(/[^a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-+$]/g,"");return input!==textName&&(ngModelCtrl.$setViewValue(input),ngModelCtrl.$render()),String(input)}),scope.$watch("ngModel",function(value){if(ngModelCtrl.$setValidity("categoryExists",!0),value){var textValue=""+value;scope.ngModel=textValue.replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()}),scope.verifyCategory(value.toUpperCase(),ngModelCtrl)}})}}}),angular.module("dashboard").factory("Config",[function(){return{url_base:"http://localhost:5000"}}]),angular.module("dashboard").factory("Socket",["$rootScope",function($rootScope){var socket=io.connect("http://localhost:8080");return{on:function(eventName,callback){socket.on(eventName,function(){var args=arguments;$rootScope.$apply(function(){callback.apply(socket,args)})})},emit:function(eventName,data,callback){socket.emit(eventName,data,function(){var args=arguments;$rootScope.$apply(function(){callback&&callback.apply(socket,args)})})}}}]),angular.module("dashboard").filter("status",function(){return function(string){return 1==string?"Ativo":"Pendente"}}),angular.module("dashboard").service("Account",["$http","$q","Config",function($http,$q,Config){var url_base=Config.url_base;this.signup=function(name,email,password){return $http.post(url_base+"/admins/account/signup",{name:name,email:email,password:password}).then(function(result){return result})},this.active=function(_id){return $http.put(url_base+"/admins/"+_id+"/account/activation").then(function(result){return result})},this.setActivationCode=function(_id){return $http.put(url_base+"/admins/"+_id+"/account/activation").then(function(result){return result})},this.setRecoveryToken=function(recoveryKey){return $http.patch(url_base+"/admins/account/recovery",recoveryKey).then(function(result){return result})},this.recoverPassword=function(recoveryKey,token,newPassword){return $http.put(url_base+"/admins/account/recovery",{recoveryKey:recoveryKey,token:token,newPassword:newPassword}).then(function(result){return result})}}]),angular.module("dashboard").service("Admins",["$http","Config",function($http,Config){var url_base=Config.url_base;this.getAdmins=function(){return $http.get(url_base+"/admins").then(function(result){return result})}}]),angular.module("dashboard").service("Auth",["$http","$q","Config",function($http,$q,Config){var url_base=Config.url_base;this.login=function(email,password){return $http.post(url_base+"/admins/auth/local/login",{email:email,password:password}).then(function(result){return result})},this.isAuthenticated=function(){return $http.get(url_base+"/admins/auth/local/login").then(function(result){return 200==result.status?"Authenticated":$q.reject("Not Authenticated")})},this.logout=function(){return $http.post(url_base+"/admins/auth/local/logout").then(function(result){return result})}}]),angular.module("dashboard").service("Verification",["$http","Config",function($http,Config){var url_base=Config.url_base;this.adminVerifyEmail=function(email){return $http.get(url_base+"/verifications/admins?email="+email).then(function(result){return result})}}]),angular.module("dashboard").service("Categories",["$http","Config",function($http,Config){var url_base=Config.url_base;this.getCategories=function(){return $http.get(url_base+"/categories").then(function(result){return result})},this.createCategory=function(title){return $http.post(url_base+"/categories",{title:title}).then(function(result){return result})},this.getCategory=function(id){return $http.get(url_base+"/categories/"+id).then(function(result){return result})},this.updateCategory=function(id,title){return $http.put(url_base+"/categories/"+id,{title:title}).then(function(result){return result})},this.deleteCategory=function(id){return $http.delete(url_base+"/categories/"+id).then(function(result){return result})}}]);